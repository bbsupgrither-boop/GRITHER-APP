РїВ»С—import { useState, useEffect, useRef } from 'react';
import { Menu, User, ArrowLeft, Clock, Plus, Info, ArrowRight, Calendar, ChevronDown, X, Check, Paperclip, TrendingUp, TrendingDown, Minus } from './Icons';
import { Dialog, DialogContent, DialogTitle, DialogDescription } from './ui/dialog';
import { Avatar, AvatarImage, AvatarFallback } from './ui/avatar';
import { LeaderboardEntry, Battle } from '../types/global';

type SortType = 'level' | 'achievements' | 'balance';

interface UserData {
  id: number;
  name: string;
  team: string;
  level: number;
  balance: string;
  achievements: number;
  avatar?: string;
}

interface BattleData {
  id: number;
  challenger: string;
  opponent: string;
  status: 'active' | 'finished';
  winner?: 'challenger' | 'opponent';
}

interface BattleHistoryData {
  id: number;
  challenger: string;
  opponent: string;
  winner: 'challenger' | 'opponent';
  date: string;
  stake: {
    amount: string;
  };
}

interface ActiveBattle {
  id: number;
  challenger: string;
  opponent: string;
  stake: string;
  date: string;
  status: 'pending' | 'accepted' | 'completed';
  challengerEvidence?: string;
  opponentEvidence?: string;
}

interface WeeklyHistory {
  weekStart: string; // Р В РІР‚СњР В Р’В°Р РЋРІР‚С™Р В Р’В° Р В Р вЂ¦Р В Р’В°Р РЋРІР‚РЋР В Р’В°Р В Р’В»Р В Р’В° Р В Р вЂ¦Р В Р’ВµР В РўвЂР В Р’ВµР В Р’В»Р В РЎвЂ (Р В Р вЂ Р В РЎвЂўР РЋР С“Р В РЎвЂќР РЋР вЂљР В Р’ВµР РЋР С“Р В Р’ВµР В Р вЂ¦Р РЋР Р‰Р В Р’Вµ)
  weekEnd: string;   // Р В РІР‚СњР В Р’В°Р РЋРІР‚С™Р В Р’В° Р В РЎвЂќР В РЎвЂўР В Р вЂ¦Р РЋРІР‚В Р В Р’В° Р В Р вЂ¦Р В Р’ВµР В РўвЂР В Р’ВµР В Р’В»Р В РЎвЂ (Р РЋР С“Р РЋРЎвЂњР В Р’В±Р В Р’В±Р В РЎвЂўР РЋРІР‚С™Р В Р’В°) 
  battles: BattleHistoryData[];
}

interface AllTimeHistory {
  battles: BattleHistoryData[];
}

interface Employee {
  id: number;
  name: string;
  team: number;
  avatar?: string;
}

interface Team {
  id: number;
  name: string;
}

interface BattleLeaderboardProps {
  leaderboard?: LeaderboardEntry[];
  activeBattles?: Battle[];
  onNavigate?: (page: string) => void;
  personalBattles?: any[];
  setPersonalBattles?: (battles: any[]) => void;
  theme?: 'light' | 'dark';
}

export function BattleLeaderboard({ leaderboard = [], activeBattles = [], onNavigate, personalBattles = [], setPersonalBattles, theme = 'light' }: BattleLeaderboardProps) {
  const [sortType, setSortType] = useState<SortType>('level');
  const [isUsersDialogOpen, setIsUsersDialogOpen] = useState(false);
  const [dialogSortType, setDialogSortType] = useState<SortType>('level');
  const [isBattleHistoryOpen, setIsBattleHistoryOpen] = useState(false);
  const [isBattleDetailsOpen, setIsBattleDetailsOpen] = useState(false);
  const [isAllTimeHistoryOpen, setIsAllTimeHistoryOpen] = useState(false);
  const [isCreateBattleOpen, setIsCreateBattleOpen] = useState(false);
  const [isBattleConfirmOpen, setIsBattleConfirmOpen] = useState(false);
  const [isTeamFilterOpen, setIsTeamFilterOpen] = useState(false);
  const [selectedBattle, setSelectedBattle] = useState<BattleHistoryData | null>(null);
  const [selectedEmployee, setSelectedEmployee] = useState<Employee | null>(null);
  const [selectedTeamFilter, setSelectedTeamFilter] = useState<number | null>(null);
  const [createBattleTab, setCreateBattleTab] = useState<'employees' | 'battles'>('employees');
  const [battleStake, setBattleStake] = useState('');
  const [isCancelBattleOpen, setIsCancelBattleOpen] = useState(false);
  const [isEvidenceModalOpen, setIsEvidenceModalOpen] = useState(false);
  const [evidenceComment, setEvidenceComment] = useState('');
  const [attachedFile, setAttachedFile] = useState<File | null>(null);
  
  // Ref Р В РўвЂР В Р’В»Р РЋР РЏ Р В Р вЂ Р РЋРІР‚в„–Р В РЎвЂ”Р В Р’В°Р В РўвЂР В Р’В°Р РЋР вЂ№Р РЋРІР‚В°Р В Р’ВµР В РЎвЂ“Р В РЎвЂў Р В РЎВР В Р’ВµР В Р вЂ¦Р РЋР вЂ№ Р В РЎвЂќР В РЎвЂўР В РЎВР В Р’В°Р В Р вЂ¦Р В РўвЂ
  const teamFilterRef = useRef<HTMLDivElement>(null);

  // Р В РЎСџР РЋР вЂљР В Р’ВµР В РЎвЂўР В Р’В±Р РЋР вЂљР В Р’В°Р В Р’В·Р РЋРЎвЂњР В Р’ВµР В РЎВ Р В РўвЂР В Р’В°Р В Р вЂ¦Р В Р вЂ¦Р РЋРІР‚в„–Р В Р’Вµ Р В Р’В»Р В РЎвЂР В РўвЂР В Р’ВµР РЋР вЂљР В Р’В±Р В РЎвЂўР РЋР вЂљР В РўвЂР В Р’В° Р В Р вЂ  placeholder Р РЋРІР‚С›Р В РЎвЂўР РЋР вЂљР В РЎВР В Р’В°Р РЋРІР‚С™ Р В РЎвЂР В Р’В»Р В РЎвЂ Р В РЎвЂР РЋР С“Р В РЎвЂ”Р В РЎвЂўР В Р’В»Р РЋР Р‰Р В Р’В·Р РЋРЎвЂњР В Р’ВµР В РЎВ Р РЋРІР‚С™Р В Р’ВµР РЋР С“Р РЋРІР‚С™Р В РЎвЂўР В Р вЂ Р РЋРІР‚в„–Р В Р’Вµ Р В РўвЂР В Р’В°Р В Р вЂ¦Р В Р вЂ¦Р РЋРІР‚в„–Р В Р’Вµ
  const users: UserData[] = leaderboard.length > 0 
    ? leaderboard.map((entry, index) => ({
        id: index + 1,
        name: entry.user.name || 'Placeholder',
        team: `Team ${Math.floor(Math.random() * 6) + 1}`,
        level: entry.score || Math.floor(Math.random() * 20) + 1,
        balance: `${Math.floor(Math.random() * 10000) + 1000}g`,
        achievements: Math.floor(Math.random() * 50) + 1,
        avatar: entry.user.avatar || ''
      }))
    : [
        // Р В РЎС›Р В Р’ВµР РЋР С“Р РЋРІР‚С™Р В РЎвЂўР В Р вЂ Р РЋРІР‚в„–Р В Р’Вµ Р В РўвЂР В Р’В°Р В Р вЂ¦Р В Р вЂ¦Р РЋРІР‚в„–Р В Р’Вµ Р В РўвЂР В Р’В»Р РЋР РЏ Р В РўвЂР В Р’ВµР В РЎВР В РЎвЂўР В Р вЂ¦Р РЋР С“Р РЋРІР‚С™Р РЋР вЂљР В Р’В°Р РЋРІР‚В Р В РЎвЂР В РЎвЂ Р РЋР С“Р В РЎвЂўР РЋР вЂљР РЋРІР‚С™Р В РЎвЂР РЋР вЂљР В РЎвЂўР В Р вЂ Р В РЎвЂќР В РЎвЂ
        { id: 1, name: 'Р В РЎвЂ™Р В Р вЂ¦Р В Р вЂ¦Р В Р’В° Р В Р’ВР В Р вЂ Р В Р’В°Р В Р вЂ¦Р В РЎвЂўР В Р вЂ Р В Р’В°', team: 'Team 1', level: 15, balance: '5400g', achievements: 32, avatar: '' },
        { id: 2, name: 'Р В РЎСџР В Р’ВµР РЋРІР‚С™Р РЋР вЂљ Р В РЎСџР В Р’ВµР РЋРІР‚С™Р РЋР вЂљР В РЎвЂўР В Р вЂ ', team: 'Team 2', level: 12, balance: '8200g', achievements: 28, avatar: '' },
        { id: 3, name: 'Р В РЎС™Р В Р’В°Р РЋР вЂљР В РЎвЂР РЋР РЏ Р В Р Р‹Р В РЎвЂР В РўвЂР В РЎвЂўР РЋР вЂљР В РЎвЂўР В Р вЂ Р В Р’В°', team: 'Team 3', level: 18, balance: '3600g', achievements: 45, avatar: '' }
      ];

  // Р В Р’В¤Р РЋРЎвЂњР В Р вЂ¦Р В РЎвЂќР РЋРІР‚В Р В РЎвЂР РЋР РЏ Р В РўвЂР В Р’В»Р РЋР РЏ Р В РЎвЂ”Р В РЎвЂўР В Р’В»Р РЋРЎвЂњР РЋРІР‚РЋР В Р’ВµР В Р вЂ¦Р В РЎвЂР РЋР РЏ Р В РўвЂР В Р’В°Р РЋРІР‚С™Р РЋРІР‚в„– Р В Р вЂ¦Р В Р’В°Р РЋРІР‚РЋР В Р’В°Р В Р’В»Р В Р’В° Р В Р вЂ¦Р В Р’ВµР В РўвЂР В Р’ВµР В Р’В»Р В РЎвЂ (Р В Р вЂ Р В РЎвЂўР РЋР С“Р В РЎвЂќР РЋР вЂљР В Р’ВµР РЋР С“Р В Р’ВµР В Р вЂ¦Р РЋР Р‰Р В Р’Вµ)
  const getWeekStart = (date: Date = new Date()): Date => {
    const d = new Date(date);
    const day = d.getDay();
    const diff = d.getDate() - day;
    return new Date(d.setDate(diff));
  };

  // Р В Р’В¤Р РЋРЎвЂњР В Р вЂ¦Р В РЎвЂќР РЋРІР‚В Р В РЎвЂР РЋР РЏ Р В РўвЂР В Р’В»Р РЋР РЏ Р В РЎвЂ”Р В РЎвЂўР В Р’В»Р РЋРЎвЂњР РЋРІР‚РЋР В Р’ВµР В Р вЂ¦Р В РЎвЂР РЋР РЏ Р В РўвЂР В Р’В°Р РЋРІР‚С™Р РЋРІР‚в„– Р В РЎвЂќР В РЎвЂўР В Р вЂ¦Р РЋРІР‚В Р В Р’В° Р В Р вЂ¦Р В Р’ВµР В РўвЂР В Р’ВµР В Р’В»Р В РЎвЂ (Р РЋР С“Р РЋРЎвЂњР В Р’В±Р В Р’В±Р В РЎвЂўР РЋРІР‚С™Р В Р’В°)
  const getWeekEnd = (weekStart: Date): Date => {
    const weekEnd = new Date(weekStart);
    weekEnd.setDate(weekStart.getDate() + 6);
    return weekEnd;
  };

  // Р В Р’В¤Р РЋРЎвЂњР В Р вЂ¦Р В РЎвЂќР РЋРІР‚В Р В РЎвЂР РЋР РЏ Р В РўвЂР В Р’В»Р РЋР РЏ Р РЋРІР‚С›Р В РЎвЂўР РЋР вЂљР В РЎВР В Р’В°Р РЋРІР‚С™Р В РЎвЂР РЋР вЂљР В РЎвЂўР В Р вЂ Р В Р’В°Р В Р вЂ¦Р В РЎвЂР РЋР РЏ Р В РўвЂР В Р’В°Р РЋРІР‚С™Р РЋРІР‚в„–
  const formatDate = (date: Date): string => {
    return date.toLocaleDateString('ru-RU', { 
      day: '2-digit', 
      month: '2-digit', 
      year: '2-digit' 
    });
  };

  // Р В РЎСџР В РЎвЂўР В Р’В»Р РЋРЎвЂњР РЋРІР‚РЋР В Р’В°Р В Р’ВµР В РЎВ Р РЋРІР‚С™Р В Р’ВµР В РЎвЂќР РЋРЎвЂњР РЋРІР‚В°Р РЋРЎвЂњР РЋР вЂ№ Р В Р вЂ¦Р В Р’ВµР В РўвЂР В Р’ВµР В Р’В»Р РЋР вЂ№
  const currentWeekStart = getWeekStart();
  const currentWeekEnd = getWeekEnd(currentWeekStart);

  // Placeholder Р В РўвЂР В Р’В°Р В Р вЂ¦Р В Р вЂ¦Р РЋРІР‚в„–Р В Р’Вµ Р В РўвЂР В Р’В»Р РЋР РЏ Р В РЎвЂР РЋР С“Р РЋРІР‚С™Р В РЎвЂўР РЋР вЂљР В РЎвЂР В РЎвЂ Р В Р’В±Р В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В»Р В РЎвЂўР В Р вЂ  (Р В РЎвЂ”Р В РЎвЂўР В РЎвЂќР В Р’В° Р В РЎвЂ”Р РЋРЎвЂњР РЋР С“Р РЋРІР‚С™Р РЋРІР‚в„–Р В Р’Вµ)
  const weeklyHistory: WeeklyHistory = {
    weekStart: formatDate(currentWeekStart),
    weekEnd: formatDate(currentWeekEnd),
    battles: []
  };

  // Placeholder Р В РўвЂР В Р’В°Р В Р вЂ¦Р В Р вЂ¦Р РЋРІР‚в„–Р В Р’Вµ Р В РўвЂР В Р’В»Р РЋР РЏ Р В РЎвЂР РЋР С“Р РЋРІР‚С™Р В РЎвЂўР РЋР вЂљР В РЎвЂР В РЎвЂ Р В Р’В·Р В Р’В° Р В Р вЂ Р РЋР С“Р В Р’Вµ Р В Р вЂ Р РЋР вЂљР В Р’ВµР В РЎВР РЋР РЏ (Р В РЎвЂ”Р В РЎвЂўР В РЎвЂќР В Р’В° Р В РЎвЂ”Р РЋРЎвЂњР РЋР С“Р РЋРІР‚С™Р РЋРІР‚в„–Р В Р’Вµ)
  const allTimeHistory: AllTimeHistory = {
    battles: []
  };

  // Mock Р В РўвЂР В Р’В°Р В Р вЂ¦Р В Р вЂ¦Р РЋРІР‚в„–Р В Р’Вµ Р РЋР С“Р В РЎвЂўР РЋРІР‚С™Р РЋР вЂљР РЋРЎвЂњР В РўвЂР В Р вЂ¦Р В РЎвЂР В РЎвЂќР В РЎвЂўР В Р вЂ  Р РЋР С“ Р В РЎвЂќР В РЎвЂўР В РЎВР В Р’В°Р В Р вЂ¦Р В РўвЂР В Р’В°Р В РЎВР В РЎвЂ (Р РЋРІР‚С™Р В РЎвЂўР В Р’В»Р РЋР Р‰Р В РЎвЂќР В РЎвЂў 1-6 Р В РЎвЂќР В РЎвЂўР В РЎВР В Р’В°Р В Р вЂ¦Р В РўвЂР РЋРІР‚в„– Р В РЎВР В РЎвЂўР В РЎвЂ“Р РЋРЎвЂњР РЋРІР‚С™ Р В Р’В±Р В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В»Р В РЎвЂР РЋРІР‚С™Р РЋР Р‰Р РЋР С“Р РЋР РЏ)
  const allEmployees: Employee[] = [
    { id: 1, name: 'Р В РЎвЂ™Р В Р вЂ¦Р В Р вЂ¦Р В Р’В° Р В Р’ВР В Р вЂ Р В Р’В°Р В Р вЂ¦Р В РЎвЂўР В Р вЂ Р В Р’В°', team: 1, avatar: undefined },
    { id: 2, name: 'Р В РЎСџР В Р’ВµР РЋРІР‚С™Р РЋР вЂљ Р В РЎСџР В Р’ВµР РЋРІР‚С™Р РЋР вЂљР В РЎвЂўР В Р вЂ ', team: 1, avatar: undefined },
    { id: 3, name: 'Р В РЎС™Р В Р’В°Р РЋР вЂљР В РЎвЂР РЋР РЏ Р В Р Р‹Р В РЎвЂР В РўвЂР В РЎвЂўР РЋР вЂљР В РЎвЂўР В Р вЂ Р В Р’В°', team: 2, avatar: undefined },
    { id: 4, name: 'Р В РЎвЂ™Р В Р’В»Р В Р’ВµР В РЎвЂќР РЋР С“Р В Р’ВµР В РІвЂћвЂ“ Р В РЎв„ўР В РЎвЂўР В Р’В·Р В Р’В»Р В РЎвЂўР В Р вЂ ', team: 2, avatar: undefined },
    { id: 5, name: 'Р В РІР‚СћР В Р’В»Р В Р’ВµР В Р вЂ¦Р В Р’В° Р В РЎС™Р В РЎвЂўР РЋР вЂљР В РЎвЂўР В Р’В·Р В РЎвЂўР В Р вЂ Р В Р’В°', team: 3, avatar: undefined },
    { id: 6, name: 'Р В РІР‚СњР В РЎВР В РЎвЂР РЋРІР‚С™Р РЋР вЂљР В РЎвЂР В РІвЂћвЂ“ Р В РІР‚в„ўР В РЎвЂўР В Р’В»Р В РЎвЂќР В РЎвЂўР В Р вЂ ', team: 3, avatar: undefined },
    { id: 7, name: 'Р В РЎвЂєР В Р’В»Р РЋР Р‰Р В РЎвЂ“Р В Р’В° Р В Р Р‹Р В РЎвЂўР В РЎвЂќР В РЎвЂўР В Р’В»Р В РЎвЂўР В Р вЂ Р В Р’В°', team: 4, avatar: undefined },
    { id: 8, name: 'Р В Р Р‹Р В Р’ВµР РЋР вЂљР В РЎвЂ“Р В Р’ВµР В РІвЂћвЂ“ Р В РЎвЂєР РЋР вЂљР В Р’В»Р В РЎвЂўР В Р вЂ ', team: 4, avatar: undefined },
    { id: 9, name: 'Р В РЎС™Р В РЎвЂР РЋРІР‚В¦Р В Р’В°Р В РЎвЂР В Р’В» Р В Р’В Р РЋРІР‚в„–Р В Р’В±Р В Р’В°Р В РЎвЂќР В РЎвЂўР В Р вЂ ', team: 5, avatar: undefined },
    { id: 10, name: 'Р В РЎС›Р В Р’В°Р РЋРІР‚С™Р РЋР Р‰Р РЋР РЏР В Р вЂ¦Р В Р’В° Р В РІР‚ВР В Р’ВµР В Р’В»Р В РЎвЂўР В Р вЂ Р В Р’В°', team: 5, avatar: undefined },
    { id: 11, name: 'Р В РІР‚в„ўР В Р’В»Р В Р’В°Р В РўвЂР В РЎвЂР В РЎВР В РЎвЂР РЋР вЂљ Р В РЎСљР В РЎвЂўР В Р вЂ Р В РЎвЂР В РЎвЂќР В РЎвЂўР В Р вЂ ', team: 6, avatar: undefined },
    { id: 12, name: 'Р В РІР‚СћР В РЎвЂќР В Р’В°Р РЋРІР‚С™Р В Р’ВµР РЋР вЂљР В РЎвЂР В Р вЂ¦Р В Р’В° Р В РЎСџР В РЎвЂўР В РЎвЂ”Р В РЎвЂўР В Р вЂ Р В Р’В°', team: 6, avatar: undefined },
  ];

  // Р В Р’В¤Р В РЎвЂР В Р’В»Р РЋР Р‰Р РЋРІР‚С™Р РЋР вЂљР В Р’В°Р РЋРІР‚В Р В РЎвЂР РЋР РЏ Р РЋР С“Р В РЎвЂўР РЋРІР‚С™Р РЋР вЂљР РЋРЎвЂњР В РўвЂР В Р вЂ¦Р В РЎвЂР В РЎвЂќР В РЎвЂўР В Р вЂ  Р В РЎвЂ”Р В РЎвЂў Р В РЎвЂќР В РЎвЂўР В РЎВР В Р’В°Р В Р вЂ¦Р В РўвЂР В Р’Вµ (Р РЋРІР‚С™Р В РЎвЂўР В Р’В»Р РЋР Р‰Р В РЎвЂќР В РЎвЂў Р В РЎвЂќР В РЎвЂўР В РЎВР В Р’В°Р В Р вЂ¦Р В РўвЂР РЋРІР‚в„– 1-6)
  const filteredEmployees = selectedTeamFilter 
    ? allEmployees.filter(emp => emp.team === selectedTeamFilter)
    : allEmployees.filter(emp => emp.team >= 1 && emp.team <= 6);

  const [isButtonClicked, setIsButtonClicked] = useState(false);

  const handleSortClick = () => {
    // Р В РІР‚в„ўР В РЎвЂР В Р’В·Р РЋРЎвЂњР В Р’В°Р В Р’В»Р РЋР Р‰Р В Р вЂ¦Р РЋРІР‚в„–Р В РІвЂћвЂ“ Р РЋР РЉР РЋРІР‚С›Р РЋРІР‚С›Р В Р’ВµР В РЎвЂќР РЋРІР‚С™ Р В Р вЂ¦Р В Р’В°Р В Р’В¶Р В Р’В°Р РЋРІР‚С™Р В РЎвЂР РЋР РЏ
    setIsButtonClicked(true);
    setTimeout(() => setIsButtonClicked(false), 200);

    // Р В РЎСџР В Р’ВµР РЋР вЂљР В Р’ВµР В РЎвЂќР В Р’В»Р РЋР вЂ№Р РЋРІР‚РЋР В Р’ВµР В Р вЂ¦Р В РЎвЂР В Р’Вµ Р РЋРІР‚С™Р В РЎвЂР В РЎвЂ”Р В Р’В° Р РЋР С“Р В РЎвЂўР РЋР вЂљР РЋРІР‚С™Р В РЎвЂР РЋР вЂљР В РЎвЂўР В Р вЂ Р В РЎвЂќР В РЎвЂ Р В РЎвЂ”Р В РЎвЂў Р В РЎвЂќР РЋР вЂљР РЋРЎвЂњР В РЎвЂ“Р РЋРЎвЂњ
    const sortTypes: SortType[] = ['level', 'achievements', 'balance'];
    const currentIndex = sortTypes.indexOf(sortType);
    const nextIndex = (currentIndex + 1) % sortTypes.length;
    const newSortType = sortTypes[nextIndex];
    setSortType(newSortType);
    
    // Р В РЎвЂєР РЋРІР‚С™Р В Р’В»Р В Р’В°Р В РўвЂР В РЎвЂќР В Р’В° Р В РўвЂР В Р’В»Р РЋР РЏ Р В РЎвЂ”Р РЋР вЂљР В РЎвЂўР В Р вЂ Р В Р’ВµР РЋР вЂљР В РЎвЂќР В РЎвЂ Р РЋР вЂљР В Р’В°Р В Р’В±Р В РЎвЂўР РЋРІР‚С™Р РЋРІР‚в„– Р В РЎвЂќР В Р вЂ¦Р В РЎвЂўР В РЎвЂ”Р В РЎвЂќР В РЎвЂ
    console.log(`Р В Р Р‹Р В РЎвЂўР РЋР вЂљР РЋРІР‚С™Р В РЎвЂР РЋР вЂљР В РЎвЂўР В Р вЂ Р В РЎвЂќР В Р’В° Р В РЎвЂР В Р’В·Р В РЎВР В Р’ВµР В Р вЂ¦Р В Р’ВµР В Р вЂ¦Р В Р’В° Р РЋР С“ "${getSortTypeText(sortType)}" Р В Р вЂ¦Р В Р’В° "${getSortTypeText(newSortType)}"`);
  };

  const handleDialogSortClick = () => {
    // Р В РЎСџР В Р’ВµР РЋР вЂљР В Р’ВµР В РЎвЂќР В Р’В»Р РЋР вЂ№Р РЋРІР‚РЋР В Р’ВµР В Р вЂ¦Р В РЎвЂР В Р’Вµ Р РЋРІР‚С™Р В РЎвЂР В РЎвЂ”Р В Р’В° Р РЋР С“Р В РЎвЂўР РЋР вЂљР РЋРІР‚С™Р В РЎвЂР РЋР вЂљР В РЎвЂўР В Р вЂ Р В РЎвЂќР В РЎвЂ Р В Р вЂ  Р В РўвЂР В РЎвЂР В Р’В°Р В Р’В»Р В РЎвЂўР В РЎвЂ“Р В Р’Вµ
    const sortTypes: SortType[] = ['level', 'achievements', 'balance'];
    const currentIndex = sortTypes.indexOf(dialogSortType);
    const nextIndex = (currentIndex + 1) % sortTypes.length;
    setDialogSortType(sortTypes[nextIndex]);
  };

  const handleUsersClick = () => {
    setIsUsersDialogOpen(true);
  };

  const handleUserClick = (userId: number) => {
    // Р В РІР‚в„ў Р В Р’В±Р РЋРЎвЂњР В РўвЂР РЋРЎвЂњР РЋРІР‚В°Р В Р’ВµР В РЎВ Р В Р’В·Р В РўвЂР В Р’ВµР РЋР С“Р РЋР Р‰ Р В Р’В±Р РЋРЎвЂњР В РўвЂР В Р’ВµР РЋРІР‚С™ Р В РЎвЂўР РЋРІР‚С™Р В РЎвЂќР РЋР вЂљР РЋРІР‚в„–Р РЋРІР‚С™Р В РЎвЂР В Р’Вµ Р В РЎвЂ”Р РЋР вЂљР В РЎвЂўР РЋРІР‚С›Р В РЎвЂР В Р’В»Р РЋР РЏ Р В РЎвЂ”Р В РЎвЂўР В Р’В»Р РЋР Р‰Р В Р’В·Р В РЎвЂўР В Р вЂ Р В Р’В°Р РЋРІР‚С™Р В Р’ВµР В Р’В»Р РЋР РЏ
    console.log(`Р В РЎвЂєР РЋРІР‚С™Р В РЎвЂќР РЋР вЂљР РЋРІР‚в„–Р РЋРІР‚С™Р РЋР Р‰ Р В РЎвЂ”Р РЋР вЂљР В РЎвЂўР РЋРІР‚С›Р В РЎвЂР В Р’В»Р РЋР Р‰ Р В РЎвЂ”Р В РЎвЂўР В Р’В»Р РЋР Р‰Р В Р’В·Р В РЎвЂўР В Р вЂ Р В Р’В°Р РЋРІР‚С™Р В Р’ВµР В Р’В»Р РЋР РЏ ${userId}`);
  };

  const handleBattleHistoryClick = () => {
    setIsBattleHistoryOpen(true);
  };

  const handleCreateBattleClick = () => {
    setIsCreateBattleOpen(true);
  };

  const handleBattleDetailsClick = (battle: BattleHistoryData) => {
    setSelectedBattle(battle);
    setIsBattleDetailsOpen(true);
  };

  const handleAllTimeHistoryClick = () => {
    setIsAllTimeHistoryOpen(true);
  };

  const handleEmployeeChallengeClick = (employee: Employee) => {
    if (personalBattles.length > 0) return; // Р В РІР‚ВР В Р’В»Р В РЎвЂўР В РЎвЂќР В РЎвЂР РЋР вЂљР РЋРЎвЂњР В Р’ВµР В РЎВ Р В Р’ВµР РЋР С“Р В Р’В»Р В РЎвЂ Р РЋРЎвЂњР В Р’В¶Р В Р’Вµ Р В Р’ВµР РЋР С“Р РЋРІР‚С™Р РЋР Р‰ Р В Р’В°Р В РЎвЂќР РЋРІР‚С™Р В РЎвЂР В Р вЂ Р В Р вЂ¦Р РЋРІР‚в„–Р В РІвЂћвЂ“ Р В Р’В±Р В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В»
    
    setSelectedEmployee(employee);
    setIsBattleConfirmOpen(true);
  };

  const handleConfirmBattle = () => {
    if (selectedEmployee && battleStake.trim() && setPersonalBattles) {
      // Р В Р Р‹Р В РЎвЂўР В Р’В·Р В РўвЂР В Р’В°Р В Р’ВµР В РЎВ Р В Р’В°Р В РЎвЂќР РЋРІР‚С™Р В РЎвЂР В Р вЂ Р В Р вЂ¦Р РЋРІР‚в„–Р В РІвЂћвЂ“ Р В Р’В±Р В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В»
      const newBattle = {
        id: Date.now().toString(),
        challenger: {
          id: 'current-user',
          name: 'Р В РІР‚в„ўР РЋРІР‚в„–',
          team: 1,
          level: 5,
          avatar: null,
          role: 'Р В Р Р‹Р В РЎвЂўР РЋРІР‚С™Р РЋР вЂљР РЋРЎвЂњР В РўвЂР В Р вЂ¦Р В РЎвЂР В РЎвЂќ',
          achievements: 10,
          completedTasks: 25
        },
        opponent: {
          id: selectedEmployee.id.toString(),
          name: selectedEmployee.name,
          team: selectedEmployee.team,
          level: Math.floor(Math.random() * 20) + 1,
          avatar: null,
          status: 'available' as const,
          role: 'Р В Р Р‹Р В РЎвЂўР РЋРІР‚С™Р РЋР вЂљР РЋРЎвЂњР В РўвЂР В Р вЂ¦Р В РЎвЂР В РЎвЂќ',
          achievements: Math.floor(Math.random() * 50) + 1,
          completedTasks: Math.floor(Math.random() * 100) + 1
        },
        status: 'active' as const,
        prize: parseInt(battleStake),
        endDate: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000), // +7 Р В РўвЂР В Р вЂ¦Р В Р’ВµР В РІвЂћвЂ“
        created: new Date()
      };
      
      // Р В РІР‚СњР В РЎвЂўР В Р’В±Р В Р’В°Р В Р вЂ Р В Р’В»Р РЋР РЏР В Р’ВµР В РЎВ Р В РЎвЂќ Р В РЎвЂ“Р В Р’В»Р В РЎвЂўР В Р’В±Р В Р’В°Р В Р’В»Р РЋР Р‰Р В Р вЂ¦Р В РЎвЂўР В РЎВР РЋРЎвЂњ Р РЋР С“Р В РЎвЂўР РЋР С“Р РЋРІР‚С™Р В РЎвЂўР РЋР РЏР В Р вЂ¦Р В РЎвЂР РЋР вЂ№
      setPersonalBattles([...personalBattles, newBattle]);
      console.log(`Р В РІР‚ВР В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В» Р РЋР С“Р В РЎвЂўР В Р’В·Р В РўвЂР В Р’В°Р В Р вЂ¦ Р РЋР С“ ${selectedEmployee.name} Р В Р вЂ¦Р В Р’В° Р РЋР С“Р РЋРЎвЂњР В РЎВР В РЎВР РЋРЎвЂњ ${battleStake} Р В РЎвЂќР В РЎвЂўР В РЎвЂР В Р вЂ¦Р В РЎвЂўР В Р вЂ `);
      
      // Р В РЎвЂєР РЋРІР‚РЋР В РЎвЂР РЋРІР‚В°Р В Р’В°Р В Р’ВµР В РЎВ Р РЋР С“Р В РЎвЂўР РЋР С“Р РЋРІР‚С™Р В РЎвЂўР РЋР РЏР В Р вЂ¦Р В РЎвЂР В Р’Вµ
      setIsBattleConfirmOpen(false);
      setIsCreateBattleOpen(false);
      setSelectedEmployee(null);
      setBattleStake('');
    }
  };

  const handleTeamFilterClick = (teamId: number | null) => {
    setSelectedTeamFilter(teamId);
    setIsTeamFilterOpen(false);
  };

  const handleCancelBattleConfirm = () => {
    setIsBattleConfirmOpen(false);
    setSelectedEmployee(null);
    setBattleStake('');
  };

  const getSortTypeText = (type: SortType) => {
    switch (type) {
      case 'level':
        return 'Р В РЎСџР В РЎвЂў Р РЋРЎвЂњР РЋР вЂљР В РЎвЂўР В Р вЂ Р В Р вЂ¦Р РЋР вЂ№';
      case 'achievements':
        return 'Р В РЎСџР В РЎвЂў Р В Р’В°Р РЋРІР‚РЋР В РЎвЂР В Р вЂ Р В РЎвЂќР В Р’В°Р В РЎВ';
      case 'balance':
        return 'Р В РЎСџР В РЎвЂў Р В Р’В±Р В Р’В°Р В Р’В»Р В Р’В°Р В Р вЂ¦Р РЋР С“Р РЋРЎвЂњ';
      default:
        return 'Р В РЎСџР В РЎвЂў Р РЋРЎвЂњР РЋР вЂљР В РЎвЂўР В Р вЂ Р В Р вЂ¦Р РЋР вЂ№';
    }
  };

  const sortUsers = (users: UserData[], sortType: SortType): UserData[] => {
    return [...users].sort((a, b) => {
      switch (sortType) {
        case 'level':
          return b.level - a.level;
        case 'achievements':
          return b.achievements - a.achievements;
        case 'balance':
          // Р В РЎСџР В Р’В°Р РЋР вЂљР РЋР С“Р В РЎвЂР В РЎВ Р РЋРІР‚РЋР В РЎвЂР РЋР С“Р В Р’В»Р В РЎвЂўР В Р вЂ Р В РЎвЂўР В Р’Вµ Р В Р’В·Р В Р вЂ¦Р В Р’В°Р РЋРІР‚РЋР В Р’ВµР В Р вЂ¦Р В РЎвЂР В Р’Вµ Р В РЎвЂР В Р’В· Р РЋР С“Р РЋРІР‚С™Р РЋР вЂљР В РЎвЂўР В РЎвЂќР В РЎвЂ Р В Р’В±Р В Р’В°Р В Р’В»Р В Р’В°Р В Р вЂ¦Р РЋР С“Р В Р’В° Р В РўвЂР В Р’В»Р РЋР РЏ Р В РЎвЂ”Р РЋР вЂљР В Р’В°Р В Р вЂ Р В РЎвЂР В Р’В»Р РЋР Р‰Р В Р вЂ¦Р В РЎвЂўР В РІвЂћвЂ“ Р РЋР С“Р В РЎвЂўР РЋР вЂљР РЋРІР‚С™Р В РЎвЂР РЋР вЂљР В РЎвЂўР В Р вЂ Р В РЎвЂќР В РЎвЂ
          const balanceA = parseFloat(a.balance.replace(/[^\d.-]/g, '')) || 0;
          const balanceB = parseFloat(b.balance.replace(/[^\d.-]/g, '')) || 0;
          return balanceB - balanceA;
        default:
          return b.level - a.level;
      }
    });
  };

  const sortedUsers = sortUsers(users, dialogSortType);

  // Р В РЎвЂєР В Р’В±Р РЋР вЂљР В Р’В°Р В Р’В±Р В РЎвЂўР РЋРІР‚С™Р РЋРІР‚РЋР В РЎвЂР В РЎвЂќ Р В РЎвЂќР В Р’В»Р В РЎвЂР В РЎвЂќР В Р’В° Р В Р вЂ Р В Р вЂ¦Р В Р’Вµ Р В Р вЂ Р РЋРІР‚в„–Р В РЎвЂ”Р В Р’В°Р В РўвЂР В Р’В°Р РЋР вЂ№Р РЋРІР‚В°Р В Р’ВµР В РЎвЂ“Р В РЎвЂў Р В РЎВР В Р’ВµР В Р вЂ¦Р РЋР вЂ№
  useEffect(() => {
    const handleClickOutside = (event: MouseEvent) => {
      if (teamFilterRef.current && !teamFilterRef.current.contains(event.target as Node)) {
        setIsTeamFilterOpen(false);
      }
    };

    if (isTeamFilterOpen) {
      document.addEventListener('mousedown', handleClickOutside);
    }

    return () => {
      document.removeEventListener('mousedown', handleClickOutside);
    };
  }, [isTeamFilterOpen]);

  return (
    <>
      <div className="grid grid-cols-2 gap-3">
        {/* Р В РІР‚ВР В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В» Р РЋР С“Р В Р’ВµР В РЎвЂќР РЋРІР‚В Р В РЎвЂР РЋР РЏ */}
        <div 
          className={`${theme === 'dark' ? 'dark' : ''}`}
          style={{
            backgroundColor: theme === 'dark' ? '#161A22' : '#FFFFFF',
            borderRadius: '20px',
            border: theme === 'dark' 
              ? '1px solid rgba(255, 255, 255, 0.06)' 
              : '1px solid #E6E9EF',
            boxShadow: theme === 'dark' 
              ? '0 8px 24px rgba(0, 0, 0, 0.6)' 
              : '0 8px 24px rgba(0, 0, 0, 0.10)'
          }}
        >
          {/* Header */}
          <div className="flex items-center justify-between p-4 pb-0">
            <button 
              onClick={(e) => {
                e.preventDefault();
                e.stopPropagation();
                console.log('HISTORY BUTTON CLICKED!');
                handleBattleHistoryClick();
              }}
              className="p-2 rounded-full transition-all hover:scale-105"
              style={{
                background: theme === 'dark' ? 'linear-gradient(145deg, #FFFFFF, #E0E0E0)' : '#FFFFFF',
                border: theme === 'dark' ? '1px solid rgba(255, 255, 255, 0.2)' : '1px solid #E6E9EF',
                color: theme === 'dark' ? '#1A1A1A' : '#0F172A',
                boxShadow: theme === 'dark' 
                  ? '0 4px 15px rgba(255, 255, 255, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.3)' 
                  : '0 2px 8px rgba(0, 0, 0, 0.06)',
                position: 'relative',
                zIndex: 60,
                cursor: 'pointer'
              }}
              title="Р В Р’ВР РЋР С“Р РЋРІР‚С™Р В РЎвЂўР РЋР вЂљР В РЎвЂР РЋР РЏ Р В Р’В±Р В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В»Р В РЎвЂўР В Р вЂ "
            >
              <Clock className="w-4 h-4" />
            </button>
            <h3 
              className="font-medium text-center flex-1"
              style={{ color: theme === 'dark' ? '#E8ECF2' : '#0F172A' }}
            >
              Р В РІР‚ВР В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В»Р РЋРІР‚в„–
            </h3>
            <button 
              onClick={(e) => {
                e.preventDefault();
                e.stopPropagation();
                console.log('CREATE BATTLE BUTTON CLICKED!');
                handleCreateBattleClick();
              }}
              className="p-2 rounded-full transition-all hover:scale-105"
              style={{
                background: theme === 'dark' ? 'linear-gradient(145deg, #FFFFFF, #E0E0E0)' : '#FFFFFF',
                border: theme === 'dark' ? '1px solid rgba(255, 255, 255, 0.2)' : '1px solid #E6E9EF',
                color: theme === 'dark' ? '#1A1A1A' : '#0F172A',
                boxShadow: theme === 'dark' 
                  ? '0 4px 15px rgba(255, 255, 255, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.3)' 
                  : '0 2px 8px rgba(0, 0, 0, 0.06)',
                position: 'relative',
                zIndex: 60,
                cursor: 'pointer'
              }}
              title="Р В Р Р‹Р В РЎвЂўР В Р’В·Р В РўвЂР В Р’В°Р РЋРІР‚С™Р РЋР Р‰ Р В Р’В±Р В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В»"
            >
              <Plus className="w-4 h-4" />
            </button>
          </div>
          
          <div className="p-4 pt-3">
            <div className="flex items-center justify-center min-h-[50px]">
              {personalBattles.length > 0 ? (
              <div className="w-full space-y-2">
                <div className="flex items-center gap-2 justify-center">
                  <span 
                    className="text-xs font-medium truncate"
                    style={{ color: theme === 'dark' ? '#E8ECF2' : '#0F172A' }}
                  >
                    Р В РІР‚ВР В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В» Р РЋР С“ {personalBattles[0].opponent.name}
                  </span>
                </div>
                <div 
                  className="text-xs text-center"
                  style={{ color: theme === 'dark' ? '#A7B0BD' : '#6B7280' }}
                >
                  Р В Р Р‹Р РЋРІР‚С™Р В Р’В°Р В Р вЂ Р В РЎвЂќР В Р’В°: {personalBattles[0].prize}g
                </div>
                <div className="flex gap-2">
                  <button 
                    onClick={(e) => {
                      e.preventDefault();
                      e.stopPropagation();
                      console.log('VICTORY BUTTON CLICKED!', personalBattles[0]);
                      
                      // Р В РІР‚С”Р В РЎвЂўР В РЎвЂ“Р В РЎвЂР В РЎвЂќР В Р’В° Р В РЎвЂ”Р В РЎвЂўР В Р’В±Р В Р’ВµР В РўвЂР РЋРІР‚в„– Р В Р вЂ  Р В Р’В±Р В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В»Р В Р’Вµ
                      if (setPersonalBattles) {
                        const updatedBattles = personalBattles.filter((_, index) => index !== 0);
                        setPersonalBattles(updatedBattles);
                        console.log('Р В РІР‚ВР В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В» Р В Р’В·Р В Р’В°Р В Р вЂ Р В Р’ВµР РЋР вЂљР РЋРІвЂљВ¬Р В Р’ВµР В Р вЂ¦ Р В РЎвЂ”Р В РЎвЂўР В Р’В±Р В Р’ВµР В РўвЂР В РЎвЂўР В РІвЂћвЂ“!');
                      }
                    }}
                    className="flex-1 py-2 text-xs font-medium hover:scale-[0.98] transition-transform"
                    style={{
                      background: '#34C759',
                      color: '#FFFFFF',
                      borderRadius: '8px',
                      height: '28px',
                      border: 'none',
                      cursor: 'pointer',
                      position: 'relative',
                      zIndex: 50
                    }}
                  >
                    Р В РІР‚в„ўР РЋРІР‚в„–Р В РЎвЂР В РЎвЂ“Р РЋР вЂљР В Р’В°Р В Р’В»
                  </button>
                  <button 
                    onClick={(e) => {
                      e.preventDefault();
                      e.stopPropagation();
                      console.log('CANCEL BUTTON CLICKED!', personalBattles[0]);
                      
                      // Р В РІР‚С”Р В РЎвЂўР В РЎвЂ“Р В РЎвЂР В РЎвЂќР В Р’В° Р В РЎвЂўР РЋРІР‚С™Р В РЎВР В Р’ВµР В Р вЂ¦Р РЋРІР‚в„– Р В Р’В±Р В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В»Р В Р’В°
                      if (setPersonalBattles) {
                        const updatedBattles = personalBattles.filter((_, index) => index !== 0);
                        setPersonalBattles(updatedBattles);
                        console.log('Р В РІР‚ВР В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В» Р В РЎвЂўР РЋРІР‚С™Р В РЎВР В Р’ВµР В Р вЂ¦Р В Р’ВµР В Р вЂ¦!');
                      }
                    }}
                    className="py-2 px-3 text-xs font-medium hover:scale-[0.98] transition-transform"
                    style={{
                      background: '#FF3B30',
                      color: '#FFFFFF',
                      borderRadius: '8px',
                      height: '28px',
                      border: 'none',
                      cursor: 'pointer',
                      position: 'relative',
                      zIndex: 50
                    }}
                  >
                    Р В РЎвЂєР РЋРІР‚С™Р В РЎВР В Р’ВµР В Р вЂ¦Р В РЎвЂР РЋРІР‚С™Р РЋР Р‰
                  </button>
                </div>
              </div>
            ) : (
              <p 
                className="text-sm text-center opacity-70"
                style={{ color: theme === 'dark' ? '#A7B0BD' : '#6B7280' }}
              >
                Р В РЎСљР В Р’ВµР РЋРІР‚С™ Р В Р’В°Р В РЎвЂќР РЋРІР‚С™Р В РЎвЂР В Р вЂ Р В Р вЂ¦Р РЋРІР‚в„–Р РЋРІР‚В¦ Р В Р’В±Р В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В»Р В РЎвЂўР В Р вЂ 
              </p>
            )}
            </div>
          </div>
        </div>

        {/* Р В РІР‚С”Р В РЎвЂР В РўвЂР В Р’ВµР РЋР вЂљР В Р’В±Р В РЎвЂўР РЋР вЂљР В РўвЂ Р РЋР С“Р В Р’ВµР В РЎвЂќР РЋРІР‚В Р В РЎвЂР РЋР РЏ */}
        <div 
          className={`${theme === 'dark' ? 'dark' : ''}`}
          style={{
            backgroundColor: theme === 'dark' ? '#161A22' : '#FFFFFF',
            borderRadius: '20px',
            border: theme === 'dark' 
              ? '1px solid rgba(255, 255, 255, 0.06)' 
              : '1px solid #E6E9EF',
            boxShadow: theme === 'dark' 
              ? '0 8px 24px rgba(0, 0, 0, 0.6)' 
              : '0 8px 24px rgba(0, 0, 0, 0.10)'
          }}
        >
          {/* Header */}
          <div className="flex items-center justify-between p-4 pb-0">
            <button 
              onClick={(e) => {
                e.preventDefault();
                e.stopPropagation();
                console.log('SORT BUTTON CLICKED!');
                handleSortClick();
              }}
              className={`p-2 rounded-full transition-all hover:scale-105 active:scale-95 ${isButtonClicked ? 'animate-pulse' : ''}`}
              style={{
                background: theme === 'dark' ? 'linear-gradient(145deg, #FFFFFF, #E0E0E0)' : '#FFFFFF',
                border: theme === 'dark' ? '1px solid rgba(255, 255, 255, 0.2)' : '1px solid #E6E9EF',
                color: theme === 'dark' ? '#1A1A1A' : '#0F172A',
                boxShadow: theme === 'dark' 
                  ? '0 4px 15px rgba(255, 255, 255, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.3)' 
                  : '0 2px 8px rgba(0, 0, 0, 0.06)',
                animation: isButtonClicked ? 'pulse 0.2s ease-in-out' : 'none',
                position: 'relative',
                zIndex: 60,
                cursor: 'pointer'
              }}
              title={`Р В Р Р‹Р В РЎвЂўР РЋР вЂљР РЋРІР‚С™Р В РЎвЂР РЋР вЂљР В РЎвЂўР В Р вЂ Р В РЎвЂќР В Р’В°: ${getSortTypeText(sortType)} (Р В Р вЂ¦Р В Р’В°Р В Р’В¶Р В РЎВР В РЎвЂР РЋРІР‚С™Р В Р’Вµ Р В РўвЂР В Р’В»Р РЋР РЏ Р В РЎвЂР В Р’В·Р В РЎВР В Р’ВµР В Р вЂ¦Р В Р’ВµР В Р вЂ¦Р В РЎвЂР РЋР РЏ)`}
            >
              <Menu className="w-4 h-4" />
            </button>
            <div className="flex-1 text-center">
              <h3 
                className="font-medium"
                style={{ color: theme === 'dark' ? '#E8ECF2' : '#0F172A' }}
              >
                Р В РІР‚С”Р В РЎвЂР В РўвЂР В Р’ВµР РЋР вЂљР В Р’В±Р В РЎвЂўР РЋР вЂљР В РўвЂ
              </h3>
              <p 
                className="text-xs opacity-60 mt-1"
                style={{ color: theme === 'dark' ? '#A7B0BD' : '#6B7280' }}
              >
                {getSortTypeText(sortType)}
              </p>
            </div>
            <button 
              onClick={(e) => {
                e.preventDefault();
                e.stopPropagation();
                console.log('USERS BUTTON CLICKED!');
                handleUsersClick();
              }}
              className="p-2 rounded-full transition-all hover:scale-105"
              style={{
                background: theme === 'dark' ? 'linear-gradient(145deg, #FFFFFF, #E0E0E0)' : '#FFFFFF',
                border: theme === 'dark' ? '1px solid rgba(255, 255, 255, 0.2)' : '1px solid #E6E9EF',
                color: theme === 'dark' ? '#1A1A1A' : '#0F172A',
                boxShadow: theme === 'dark' 
                  ? '0 4px 15px rgba(255, 255, 255, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.3)' 
                  : '0 2px 8px rgba(0, 0, 0, 0.06)',
                position: 'relative',
                zIndex: 60,
                cursor: 'pointer'
              }}
              title="Р В РІР‚в„ўР РЋР С“Р В Р’Вµ Р В РЎвЂ”Р В РЎвЂўР В Р’В»Р РЋР Р‰Р В Р’В·Р В РЎвЂўР В Р вЂ Р В Р’В°Р РЋРІР‚С™Р В Р’ВµР В Р’В»Р В РЎвЂ"
            >
              <User className="w-4 h-4" />
            </button>
          </div>
          
          <div className="p-4 pt-3">
            <div className="flex items-center justify-center min-h-[50px]">
              {users.length > 0 ? (
              <div className="w-full space-y-1">
                {sortUsers(users, sortType).slice(0, 3).map((user, index) => (
                  <div 
                    key={`${user.id}-${sortType}`} 
                    className="flex items-center gap-2 text-xs transition-all duration-200 hover:scale-[1.02]"
                    style={{
                      animation: 'fadeIn 0.3s ease-in-out'
                    }}
                  >
                    <span 
                      className="font-medium w-4"
                      style={{ color: theme === 'dark' ? '#E8ECF2' : '#0F172A' }}
                    >
                      {index + 1}.
                    </span>
                    <span 
                      className="truncate flex-1"
                      style={{ color: theme === 'dark' ? '#E8ECF2' : '#0F172A' }}
                    >
                      {user.name}
                    </span>
                    <span 
                      className="text-xs font-medium"
                      style={{ color: theme === 'dark' ? '#A7B0BD' : '#6B7280' }}
                    >
                      {sortType === 'level' && `Р В Р в‚¬Р РЋР вЂљ.${user.level}`}
                      {sortType === 'achievements' && `${user.achievements}Р Р†Р’ВРІР‚В¦`}
                      {sortType === 'balance' && user.balance}
                    </span>
                  </div>
                ))}
              </div>
            ) : (
              <p 
                className="text-sm text-center opacity-70"
                style={{ color: theme === 'dark' ? '#A7B0BD' : '#6B7280' }}
              >
                Р В Р Р‹Р В РЎвЂ”Р В РЎвЂР РЋР С“Р В РЎвЂўР В РЎвЂќ Р В Р’В»Р В РЎвЂР В РўвЂР В Р’ВµР РЋР вЂљР В РЎвЂўР В Р вЂ  Р В РЎвЂўР РЋРІР‚С™Р РЋР С“Р РЋРЎвЂњР РЋРІР‚С™Р РЋР С“Р РЋРІР‚С™Р В Р вЂ Р РЋРЎвЂњР В Р’ВµР РЋРІР‚С™
              </p>
            )}
            </div>
          </div>
        </div>
      </div>

      {/* Р В Р’ВР РЋР С“Р РЋРІР‚С™Р В РЎвЂўР РЋР вЂљР В РЎвЂР РЋР РЏ Р В Р’В±Р В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В»Р В РЎвЂўР В Р вЂ  */}
      <Dialog open={isBattleHistoryOpen} onOpenChange={setIsBattleHistoryOpen}>
        <DialogContent 
          className="sm:max-w-md mx-auto"
          style={{
            background: theme === 'dark' ? '#1C2029' : '#FFFFFF',
            border: theme === 'dark' ? '1px solid rgba(255, 255, 255, 0.06)' : '1px solid #E6E9EF',
            boxShadow: theme === 'dark' 
              ? '0 16px 48px rgba(0, 0, 0, 0.6)' 
              : '0 16px 48px rgba(0, 0, 0, 0.12)'
          }}
        >
          <DialogTitle style={{ color: theme === 'dark' ? '#E8ECF2' : '#0F172A' }}>
            Р В Р’ВР РЋР С“Р РЋРІР‚С™Р В РЎвЂўР РЋР вЂљР В РЎвЂР РЋР РЏ Р В Р’В±Р В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В»Р В РЎвЂўР В Р вЂ 
          </DialogTitle>
          <DialogDescription style={{ color: theme === 'dark' ? '#A7B0BD' : '#6B7280' }}>
            Р В РІР‚в„ўР В Р’В°Р РЋРІвЂљВ¬Р В РЎвЂ Р В РЎвЂ”Р РЋР вЂљР В РЎвЂўР РЋРІвЂљВ¬Р В Р’В»Р РЋРІР‚в„–Р В Р’Вµ Р В Р’В±Р В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В»Р РЋРІР‚в„– Р В Р’В·Р В Р’В° Р РЋР РЉР РЋРІР‚С™Р РЋРЎвЂњ Р В Р вЂ¦Р В Р’ВµР В РўвЂР В Р’ВµР В Р’В»Р РЋР вЂ№ ({weeklyHistory.weekStart} - {weeklyHistory.weekEnd})
          </DialogDescription>
          
          <div className="space-y-3">
            {weeklyHistory.battles.length > 0 ? (
              weeklyHistory.battles.map((battle) => (
                <div 
                  key={battle.id}
                  className="p-3 rounded-lg cursor-pointer transition-colors"
                  style={{
                    background: theme === 'dark' ? '#161A22' : '#F8F9FA',
                    border: theme === 'dark' ? '1px solid rgba(255, 255, 255, 0.06)' : '1px solid #E6E9EF'
                  }}
                  onClick={() => handleBattleDetailsClick(battle)}
                >
                  <div className="flex justify-between items-center">
                    <span style={{ color: theme === 'dark' ? '#E8ECF2' : '#0F172A' }}>
                      {battle.challenger} vs {battle.opponent}
                    </span>
                    <span style={{ color: theme === 'dark' ? '#A7B0BD' : '#6B7280' }}>
                      {battle.date}
                    </span>
                  </div>
                </div>
              ))
            ) : (
              <div className="text-center py-8">
                <p style={{ color: theme === 'dark' ? '#A7B0BD' : '#6B7280' }}>
                  Р В РЎСљР В Р’В° Р РЋР РЉР РЋРІР‚С™Р В РЎвЂўР В РІвЂћвЂ“ Р В Р вЂ¦Р В Р’ВµР В РўвЂР В Р’ВµР В Р’В»Р В Р’Вµ Р В Р’В±Р В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В»Р В РЎвЂўР В Р вЂ  Р В Р вЂ¦Р В Р’Вµ Р В Р’В±Р РЋРІР‚в„–Р В Р’В»Р В РЎвЂў
                </p>
                <button 
                  onClick={handleAllTimeHistoryClick}
                  className="mt-2 text-blue-500 hover:text-blue-600"
                >
                  Р В РЎСџР В РЎвЂўР РЋР С“Р В РЎВР В РЎвЂўР РЋРІР‚С™Р РЋР вЂљР В Р’ВµР РЋРІР‚С™Р РЋР Р‰ Р В РЎвЂР РЋР С“Р РЋРІР‚С™Р В РЎвЂўР РЋР вЂљР В РЎвЂР РЋР вЂ№ Р В Р’В·Р В Р’В° Р В Р вЂ Р РЋР С“Р В Р’Вµ Р В Р вЂ Р РЋР вЂљР В Р’ВµР В РЎВР РЋР РЏ
                </button>
              </div>
            )}
          </div>
        </DialogContent>
      </Dialog>

      {/* Р В Р Р‹Р В РЎвЂўР В Р’В·Р В РўвЂР В Р’В°Р В Р вЂ¦Р В РЎвЂР В Р’Вµ Р В Р’В±Р В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В»Р В Р’В° */}
      <Dialog open={isCreateBattleOpen} onOpenChange={setIsCreateBattleOpen}>
        <DialogContent 
          className="sm:max-w-lg mx-auto"
          style={{
            background: theme === 'dark' ? '#1C2029' : '#FFFFFF',
            border: theme === 'dark' ? '1px solid rgba(255, 255, 255, 0.06)' : '1px solid #E6E9EF',
            boxShadow: theme === 'dark' 
              ? '0 16px 48px rgba(0, 0, 0, 0.6)' 
              : '0 16px 48px rgba(0, 0, 0, 0.12)'
          }}
        >
          <DialogTitle style={{ color: theme === 'dark' ? '#E8ECF2' : '#0F172A' }}>
            Р В Р Р‹Р В РЎвЂўР В Р’В·Р В РўвЂР В Р’В°Р РЋРІР‚С™Р РЋР Р‰ Р В Р’В±Р В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В»
          </DialogTitle>
          <DialogDescription style={{ color: theme === 'dark' ? '#A7B0BD' : '#6B7280' }}>
            Р В РІР‚в„ўР РЋРІР‚в„–Р В Р’В±Р В Р’ВµР РЋР вЂљР В РЎвЂР РЋРІР‚С™Р В Р’Вµ Р РЋР С“Р В РЎвЂўР В РЎвЂ”Р В Р’ВµР РЋР вЂљР В Р вЂ¦Р В РЎвЂР В РЎвЂќР В Р’В° Р В РўвЂР В Р’В»Р РЋР РЏ Р В Р’В±Р В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В»Р В Р’В°
          </DialogDescription>
          
          <div className="space-y-4">
            {/* Р В Р’В¤Р В РЎвЂР В Р’В»Р РЋР Р‰Р РЋРІР‚С™Р РЋР вЂљ Р В РЎвЂ”Р В РЎвЂў Р В РЎвЂќР В РЎвЂўР В РЎВР В Р’В°Р В Р вЂ¦Р В РўвЂР В Р’В°Р В РЎВ */}
            <div className="relative" ref={teamFilterRef}>
              <button
                onClick={() => setIsTeamFilterOpen(!isTeamFilterOpen)}
                className="w-full p-2 text-left rounded-lg border flex justify-between items-center"
                style={{
                  background: theme === 'dark' ? '#161A22' : '#F8F9FA',
                  border: theme === 'dark' ? '1px solid rgba(255, 255, 255, 0.06)' : '1px solid #E6E9EF',
                  color: theme === 'dark' ? '#E8ECF2' : '#0F172A'
                }}
              >
                {selectedTeamFilter ? `Р В РЎв„ўР В РЎвЂўР В РЎВР В Р’В°Р В Р вЂ¦Р В РўвЂР В Р’В° ${selectedTeamFilter}` : 'Р В РІР‚в„ўР РЋР С“Р В Р’Вµ Р В РЎвЂќР В РЎвЂўР В РЎВР В Р’В°Р В Р вЂ¦Р В РўвЂР РЋРІР‚в„–'}
                <ChevronDown className="w-4 h-4" />
              </button>
              
              {isTeamFilterOpen && (
                <div 
                  className="absolute top-full left-0 right-0 mt-1 border rounded-lg z-50 max-h-48 overflow-y-auto"
                  style={{
                    background: theme === 'dark' ? '#161A22' : '#FFFFFF',
                    border: theme === 'dark' ? '1px solid rgba(255, 255, 255, 0.06)' : '1px solid #E6E9EF',
                    boxShadow: theme === 'dark' ? '0 8px 24px rgba(0, 0, 0, 0.6)' : '0 8px 24px rgba(0, 0, 0, 0.10)'
                  }}
                >
                  <button
                    onClick={() => handleTeamFilterClick(null)}
                    className="w-full p-2 text-left hover:bg-opacity-50"
                    style={{
                      color: theme === 'dark' ? '#E8ECF2' : '#0F172A',
                      backgroundColor: !selectedTeamFilter ? (theme === 'dark' ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.05)') : 'transparent'
                    }}
                  >
                    Р В РІР‚в„ўР РЋР С“Р В Р’Вµ Р В РЎвЂќР В РЎвЂўР В РЎВР В Р’В°Р В Р вЂ¦Р В РўвЂР РЋРІР‚в„–
                  </button>
                  {[1, 2, 3, 4, 5, 6].map(teamId => (
                    <button
                      key={teamId}
                      onClick={() => handleTeamFilterClick(teamId)}
                      className="w-full p-2 text-left hover:bg-opacity-50"
                      style={{
                        color: theme === 'dark' ? '#E8ECF2' : '#0F172A',
                        backgroundColor: selectedTeamFilter === teamId ? (theme === 'dark' ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.05)') : 'transparent'
                      }}
                    >
                      Р В РЎв„ўР В РЎвЂўР В РЎВР В Р’В°Р В Р вЂ¦Р В РўвЂР В Р’В° {teamId}
                    </button>
                  ))}
                </div>
              )}
            </div>

            {/* Р В Р Р‹Р В РЎвЂ”Р В РЎвЂР РЋР С“Р В РЎвЂўР В РЎвЂќ Р РЋР С“Р В РЎвЂўР РЋРІР‚С™Р РЋР вЂљР РЋРЎвЂњР В РўвЂР В Р вЂ¦Р В РЎвЂР В РЎвЂќР В РЎвЂўР В Р вЂ  */}
            <div className="space-y-2 max-h-64 overflow-y-auto">
              {filteredEmployees.map((employee) => (
                <div
                  key={employee.id}
                  className="flex items-center justify-between p-3 rounded-lg cursor-pointer transition-colors"
                  style={{
                    background: theme === 'dark' ? '#161A22' : '#F8F9FA',
                    border: theme === 'dark' ? '1px solid rgba(255, 255, 255, 0.06)' : '1px solid #E6E9EF'
                  }}
                  onClick={() => handleEmployeeChallengeClick(employee)}
                >
                  <div className="flex items-center gap-3">
                    <Avatar className="w-8 h-8">
                      <AvatarImage src={employee.avatar} />
                      <AvatarFallback style={{
                        background: theme === 'dark' ? '#2A3340' : '#E6E9EF',
                        color: theme === 'dark' ? '#E8ECF2' : '#0F172A'
                      }}>
                        {employee.name.charAt(0)}
                      </AvatarFallback>
                    </Avatar>
                    <div>
                      <div style={{ color: theme === 'dark' ? '#E8ECF2' : '#0F172A' }}>
                        {employee.name}
                      </div>
                      <div style={{ color: theme === 'dark' ? '#A7B0BD' : '#6B7280' }} className="text-sm">
                        Р В РЎв„ўР В РЎвЂўР В РЎВР В Р’В°Р В Р вЂ¦Р В РўвЂР В Р’В° {employee.team}
                      </div>
                    </div>
                  </div>
                  <button
                    className="px-4 py-2 rounded-lg transition-colors"
                    style={{
                      background: personalBattles.length > 0 ? (theme === 'dark' ? '#2A3340' : '#E6E9EF') : '#2B82FF',
                      color: personalBattles.length > 0 ? (theme === 'dark' ? '#6B7280' : '#9CA3AF') : '#FFFFFF'
                    }}
                    disabled={personalBattles.length > 0}
                  >
                    {personalBattles.length > 0 ? 'Р В РІР‚ВР В Р’В»Р В РЎвЂўР В РЎвЂќР В РЎвЂР РЋР вЂљР В РЎвЂўР В Р вЂ Р В Р’В°Р В Р вЂ¦Р В РЎвЂў' : 'Р В РІР‚в„ўР РЋРІР‚в„–Р В Р’В·Р В Р вЂ Р В Р’В°Р РЋРІР‚С™Р РЋР Р‰'}
                  </button>
                </div>
              ))}
            </div>
          </div>
        </DialogContent>
      </Dialog>

      {/* Р В РЎСџР В РЎвЂўР В РўвЂР РЋРІР‚С™Р В Р вЂ Р В Р’ВµР РЋР вЂљР В Р’В¶Р В РўвЂР В Р’ВµР В Р вЂ¦Р В РЎвЂР В Р’Вµ Р РЋР С“Р В РЎвЂўР В Р’В·Р В РўвЂР В Р’В°Р В Р вЂ¦Р В РЎвЂР РЋР РЏ Р В Р’В±Р В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В»Р В Р’В° */}
      <Dialog open={isBattleConfirmOpen} onOpenChange={setIsBattleConfirmOpen}>
        <DialogContent 
          className="sm:max-w-md mx-auto"
          style={{
            background: theme === 'dark' ? '#1C2029' : '#FFFFFF',
            border: theme === 'dark' ? '1px solid rgba(255, 255, 255, 0.06)' : '1px solid #E6E9EF',
            boxShadow: theme === 'dark' 
              ? '0 16px 48px rgba(0, 0, 0, 0.6)' 
              : '0 16px 48px rgba(0, 0, 0, 0.12)'
          }}
        >
          <DialogTitle style={{ color: theme === 'dark' ? '#E8ECF2' : '#0F172A' }}>
            Р В РЎСџР В РЎвЂўР В РўвЂР РЋРІР‚С™Р В Р вЂ Р В Р’ВµР РЋР вЂљР В Р’В¶Р В РўвЂР В Р’ВµР В Р вЂ¦Р В РЎвЂР В Р’Вµ Р В Р’В±Р В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В»Р В Р’В°
          </DialogTitle>
          <DialogDescription style={{ color: theme === 'dark' ? '#A7B0BD' : '#6B7280' }}>
            Р В РІР‚в„ўР РЋРІР‚в„–Р В Р’В·Р В Р вЂ Р В Р’В°Р РЋРІР‚С™Р РЋР Р‰ Р В Р вЂ¦Р В Р’В° Р В Р’В±Р В Р’В°Р РЋРІР‚С™Р РЋРІР‚С™Р В Р’В» {selectedEmployee?.name}?
          </DialogDescription>
          
          <div className="space-y-4">
            <div>
              <label 
                className="block text-sm font-medium mb-2"
                style={{ color: theme === 'dark' ? '#E8ECF2' : '#0F172A' }}
              >
                Р В Р Р‹Р РЋРІР‚С™Р В Р’В°Р В Р вЂ Р В РЎвЂќР В Р’В° (Р В РЎвЂќР В РЎвЂўР В РЎвЂР В Р вЂ¦Р РЋРІР‚в„–)
              </label>
              <input
                type="number"
                value={battleStake}
                onChange={(e) => setBattleStake(e.target.value)}
                placeholder="100"
                className="w-full p-2 border rounded-lg"
                style={{
                  background: theme === 'dark' ? '#161A22' : '#FFFFFF',
                  border: theme === 'dark' ? '1px solid rgba(255, 255, 255, 0.06)' : '1px solid #E6E9EF',
                  color: theme === 'dark' ? '#E8ECF2' : '#0F172A'
                }}
              />
            </div>
            
            <div className="flex gap-2">
              <button
                onClick={handleConfirmBattle}
                disabled={!battleStake.trim()}
                className="flex-1 py-2 px-4 rounded-lg transition-colors"
                style={{
                  background: !battleStake.trim() ? (theme === 'dark' ? '#2A3340' : '#E6E9EF') : '#2B82FF',
                  color: !battleStake.trim() ? (theme === 'dark' ? '#6B7280' : '#9CA3AF') : '#FFFFFF'
                }}
              >
                Р В РЎСџР В РЎвЂўР В РўвЂР РЋРІР‚С™Р В Р вЂ Р В Р’ВµР РЋР вЂљР В РўвЂР В РЎвЂР РЋРІР‚С™Р РЋР Р‰
              </button>
              <button
                onClick={handleCancelBattleConfirm}
                className="px-4 py-2 rounded-lg transition-colors"
                style={{
                  background: theme === 'dark' ? '#2A3340' : '#E6E9EF',
                  color: theme === 'dark' ? '#E8ECF2' : '#0F172A'
                }}
              >
                Р В РЎвЂєР РЋРІР‚С™Р В РЎВР В Р’ВµР В Р вЂ¦Р В Р’В°
              </button>
            </div>
          </div>
        </DialogContent>
      </Dialog>

      {/* Р В РІР‚в„ўР РЋР С“Р В Р’Вµ Р В РЎвЂ”Р В РЎвЂўР В Р’В»Р РЋР Р‰Р В Р’В·Р В РЎвЂўР В Р вЂ Р В Р’В°Р РЋРІР‚С™Р В Р’ВµР В Р’В»Р В РЎвЂ */}
      <Dialog open={isUsersDialogOpen} onOpenChange={setIsUsersDialogOpen}>
        <DialogContent 
          className="sm:max-w-md mx-auto"
          style={{
            background: theme === 'dark' ? '#1C2029' : '#FFFFFF',
            border: theme === 'dark' ? '1px solid rgba(255, 255, 255, 0.06)' : '1px solid #E6E9EF',
            boxShadow: theme === 'dark' 
              ? '0 16px 48px rgba(0, 0, 0, 0.6)' 
              : '0 16px 48px rgba(0, 0, 0, 0.12)'
          }}
        >
          <DialogTitle style={{ color: theme === 'dark' ? '#E8ECF2' : '#0F172A' }}>
            Р В РІР‚в„ўР РЋР С“Р В Р’Вµ Р В РЎвЂ”Р В РЎвЂўР В Р’В»Р РЋР Р‰Р В Р’В·Р В РЎвЂўР В Р вЂ Р В Р’В°Р РЋРІР‚С™Р В Р’ВµР В Р’В»Р В РЎвЂ
          </DialogTitle>
          <DialogDescription style={{ color: theme === 'dark' ? '#A7B0BD' : '#6B7280' }}>
            Р В РЎСџР В РЎвЂўР В Р’В»Р В Р вЂ¦Р РЋРІР‚в„–Р В РІвЂћвЂ“ Р РЋР С“Р В РЎвЂ”Р В РЎвЂР РЋР С“Р В РЎвЂўР В РЎвЂќ Р РЋРЎвЂњР РЋРІР‚РЋР В Р’В°Р РЋР С“Р РЋРІР‚С™Р В Р вЂ¦Р В РЎвЂР В РЎвЂќР В РЎвЂўР В Р вЂ  - {getSortTypeText(dialogSortType)}
          </DialogDescription>
          
          <div className="flex justify-between items-center mb-4">
            <span style={{ color: theme === 'dark' ? '#E8ECF2' : '#0F172A' }}>
              Р В Р Р‹Р В РЎвЂўР РЋР вЂљР РЋРІР‚С™Р В РЎвЂР РЋР вЂљР В РЎвЂўР В Р вЂ Р В РЎвЂќР В Р’В°: {getSortTypeText(dialogSortType)}
            </span>
            <button
              onClick={handleDialogSortClick}
              className="p-2 rounded-lg transition-colors"
              style={{
                background: theme === 'dark' ? '#161A22' : '#F8F9FA',
                border: theme === 'dark' ? '1px solid rgba(255, 255, 255, 0.06)' : '1px solid #E6E9EF',
                color: theme === 'dark' ? '#E8ECF2' : '#0F172A'
              }}
            >
              <Menu className="w-4 h-4" />
            </button>
          </div>
          
          <div className="space-y-2 max-h-80 overflow-y-auto">
            {sortedUsers.map((user, index) => (
              <div
                key={user.id}
                className="flex items-center justify-between p-3 rounded-lg cursor-pointer transition-colors"
                style={{
                  background: theme === 'dark' ? '#161A22' : '#F8F9FA',
                  border: theme === 'dark' ? '1px solid rgba(255, 255, 255, 0.06)' : '1px solid #E6E9EF'
                }}
                onClick={() => handleUserClick(user.id)}
              >
                <div className="flex items-center gap-3">
                  <span style={{ color: theme === 'dark' ? '#A7B0BD' : '#6B7280' }}>
                    #{index + 1}
                  </span>
                  <Avatar className="w-8 h-8">
                    <AvatarImage src={user.avatar} />
                    <AvatarFallback style={{
                      background: theme === 'dark' ? '#2A3340' : '#E6E9EF',
                      color: theme === 'dark' ? '#E8ECF2' : '#0F172A'
                    }}>
                      {user.name.charAt(0)}
                    </AvatarFallback>
                  </Avatar>
                  <div>
                    <div style={{ color: theme === 'dark' ? '#E8ECF2' : '#0F172A' }}>
                      {user.name}
                    </div>
                    <div style={{ color: theme === 'dark' ? '#A7B0BD' : '#6B7280' }} className="text-sm">
                      {user.team}
                    </div>
                  </div>
                </div>
                <div style={{ color: theme === 'dark' ? '#A7B0BD' : '#6B7280' }}>
                  {dialogSortType === 'level' && `Р В Р в‚¬Р РЋР вЂљ.${user.level}`}
                  {dialogSortType === 'achievements' && `${user.achievements}Р Р†Р’ВРІР‚В¦`}
                  {dialogSortType === 'balance' && user.balance}
                </div>
              </div>
            ))}
          </div>
        </DialogContent>
      </Dialog>
    </>
  );
}
